<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Banana Guesthouse - Management Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    /* [Your existing full CSS code goes here without changes, including the fix: justify-content: space-between] */
    /* For brevity here, just reuse the CSS you already have, but ensure this fix is made: */
    .card-header {
      justify-content: space-between;
      /* rest unchanged... */
    }
  </style>
</head>
<body>
  <div class="dashboard-container">
    <!-- [Your existing sidebar + main content HTML exactly as written goes here] -->
    <!-- No changes needed in structure -->
  </div>

  <script>
    function addRow(containerId) {
      const container = document.getElementById(containerId);
      const newRow = document.createElement("div");
      newRow.className = "list-item";
      newRow.innerHTML = `
        <input type="text" class="form-input" placeholder="Description" onchange="calculate()">
        <input type="text" class="form-input number-input" placeholder="0" onchange="calculate()">
        <span style="color: #64748b; font-size: 0.875rem;">THB</span>
        <div class="list-actions">
            <button class="btn-icon btn-remove" onclick="removeRow(this)">üóë</button>
        </div>
      `;
      container.appendChild(newRow);
      calculate();
    }

    function removeRow(button) {
      button.closest(".list-item").remove();
      calculate();
    }

    function parseNumber(value) {
      return parseInt(value.replace(/,/g, "")) || 0;
    }

    function formatNumber(num) {
      return num.toLocaleString();
    }

    function calculate() {
      const totalRooms = parseNumber(document.getElementById("totalRooms").value) || 74;
      const adr = parseNumber(document.getElementById("adr").value) || 1500;
      const occupancy = parseNumber(document.getElementById("occupancy").value) || 70;
      const commission = parseNumber(document.getElementById("commission").value) || 15;
      const variableCost = parseNumber(document.getElementById("variableCost").value) || 300;

      let fixedCosts = 0;
      document.querySelectorAll("#fixedCosts .list-item").forEach(row => {
        const input = row.querySelector(".number-input");
        if (input) fixedCosts += parseNumber(input.value);
      });

      let laborCosts = 0;
      document.querySelectorAll("#laborCosts .list-item").forEach(row => {
        const input = row.querySelector(".number-input");
        if (input) laborCosts += parseNumber(input.value);
      });

      let additionalRevenue = 0;
      document.querySelectorAll("#revenues .list-item").forEach(row => {
        const input = row.querySelector(".number-input");
        if (input) additionalRevenue += parseNumber(input.value);
      });

      const totalFixedCosts = fixedCosts + laborCosts;
      const effectiveADR = adr * (1 - commission / 100);
      const contributionMargin = effectiveADR - variableCost;

      const netFixedCosts = Math.max(0, totalFixedCosts - additionalRevenue);
      const breakevenRoomsPerMonth = contributionMargin > 0 ? Math.ceil(netFixedCosts / contributionMargin) : 0;
      const breakevenOccupancyRate = (breakevenRoomsPerMonth / (totalRooms * 30)) * 100;
      const dailyBreakevenRooms = Math.ceil(breakevenRoomsPerMonth / 30);

      const roomsPerMonth = totalRooms * 30 * (occupancy / 100);
      const roomRevenue = roomsPerMonth * effectiveADR;
      const totalRevenue = roomRevenue + additionalRevenue;
      const totalCosts = totalFixedCosts + (roomsPerMonth * variableCost);
      const monthlyProfit = totalRevenue - totalCosts;
      const profitMargin = totalRevenue > 0 ? (monthlyProfit / totalRevenue) * 100 : 0;
      const safetyMargin = totalRevenue * 1.2;

      document.getElementById("breakevenOccupancy").textContent = `${breakevenOccupancyRate.toFixed(1)}%`;
      document.getElementById("monthlyRevenue").textContent = `‡∏ø${formatNumber(totalRevenue)}`;
      document.getElementById("monthlyProfit").textContent = `‡∏ø${formatNumber(monthlyProfit)}`;
      document.getElementById("dailyBreakeven").textContent = dailyBreakevenRooms;
      document.getElementById("contributionMargin").textContent = `‡∏ø${formatNumber(contributionMargin)}`;
      document.getElementById("totalCosts").textContent = `‡∏ø${formatNumber(totalCosts)}`;
      document.getElementById("safetyMargin").textContent = `‡∏ø${formatNumber(safetyMargin)}`;
      document.getElementById("profitMargin").textContent = `${profitMargin.toFixed(1)}%`;

      const alertContainer = document.getElementById("alertContainer");
      alertContainer.innerHTML = "";

      if (breakevenOccupancyRate > 90) {
        const alert = document.createElement("div");
        alert.className = "alert alert-warning";
        alert.textContent = "‚ö†Ô∏è Breakeven occupancy is very high. Consider reducing costs or increasing room rates.";
        alertContainer.appendChild(alert);
      } else if (monthlyProfit < 0) {
        const alert = document.createElement("div");
        alert.className = "alert alert-danger";
        alert.textContent = "‚ùå You are operating at a loss this month.";
        alertContainer.appendChild(alert);
      } else {
        const alert = document.createElement("div");
        alert.className = "alert alert-success";
        alert.textContent = "‚úÖ Your guesthouse is profitable this month!";
        alertContainer.appendChild(alert);
      }
    }

    function resetData() {
      if (confirm("Reset all data to default?")) {
        location.reload();
      }
    }

    // Run once on page load
    calculate();
  </script>
</body>
</html>
